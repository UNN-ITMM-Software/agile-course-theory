# Дизайн презентационного слоя

Антон Бевзюк (DODO Pizza)

# О чем будем говорить

  - Проблемы UI
  - Примеры плохого кода
  - Паттерны Presentation
  - Passive View в деталях
  - Два слова про TDD
  - Демо!

# Типичные болезни GUI

1. Нарушение SRP, слишком много ответственностей
    - Разметка экрана
    - Поведение (реакция на действия пользователя)
    - Ввод данных
    - Представление данных
    - Получение данных
    - События
2. Сложность тестирования
3. Сложность переиспользования / портирования

# Что же делать?

## <font color=yellow>Разделять!</font>
## <font color=green>Тестировать!</font>

# Паттерны Presentation

- Model View Controller
- Model View Presenter
    - Supervising Controller
    - Passive View
- Model View ViewModel

# Passive View

![](./images/mvvm_mvp_2.jpg)

<!-- Presenter declares an interface for view -->
<!-- View implements this interface -->
<!-- View is injected into Presenter -->
<!-- The goal is to make View passive -->
<!-- Passive View pattern -->
<!-- Presenter is responsible for updating view from model -->
<!-- No dependencies between view and model -->
<!-- Presenter subscribes to view events -->
<!-- View needs to know nothing about presenter and doesn’t need a reference to presenter -->

# Model View ViewModel

![](./images/mvvm_mvp_3.jpg)


# <font color=red>RED</font> / <font color=green>GREEN</font> / REFACTOR

+---------------------------------------------------------------------+---------------------------------------------------------------------+------------------------------------------------------------------+
|=> Подумай, напиши тест                                              |Скомпилируй                                                          |Исправь ошибки                                                    |
+---------------------------------------------------------------------+---------------------------------------------------------------------+------------------------------------------------------------------+
|<font color=green>Запусти все тесты и убедись, что они прошли</font> |![](./images/tdd_2.jpg)                                              |<font color=red>Запусти все тесты и убедись, что они упали</font> |
+---------------------------------------------------------------------+---------------------------------------------------------------------+------------------------------------------------------------------+
|Рефакторинг                                                          |<font color=green>Запусти все тесты и убедись, что они прошли</font> |Напиши код                                                        |
+---------------------------------------------------------------------+---------------------------------------------------------------------+------------------------------------------------------------------+

# Demo

# Чего мы добились?
  * SRP
  * Увереность (тесты)
  * Повторное использование?

# Контрольные вопросы

  1. Типичные проблемы с GUI (ответственности, тестирование, переносимость).
  1. Диаграмма Passive View. Ответственности слоев.
  1. Назначение и преимущества применения Passive View.
  1. Диаграмма MVVM. Ответственности слоев.
  1. Назначение и преимущества применения MVVM.

# Спасибо за внимание!

Антон Бевзюк
